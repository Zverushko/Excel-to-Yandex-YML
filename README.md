# Конвертер Excel в YML для Яндекс.Маркета

Этот инструмент позволяет конвертировать данные из Excel-файла в XML-фид формата YML для Яндекс.Маркета. Вы можете заполнить шаблон Excel своими данными и сгенерировать готовый XML-файл для загрузки в Яндекс.Маркет.

## Возможности

- Конвертация данных из Excel в YML-формат
- Поддержка всех необходимых элементов YML-фида:
  - Информация о магазине
  - Валюты
  - Категории и подкатегории
  - Товары с параметрами

## Требования

- Go 1.16 или выше
- Библиотека: github.com/xuri/excelize/v2

## Установка

### Клонирование репозитория

```bash
git clone https://github.com/ваш-репозиторий/yandex_fid.git
cd yandex_fid
```

### Установка зависимостей

```bash
go mod download
```

## Использование

### Запуск программы

```bash
# Запустить программу
go run excel_to_yml.go
```

Это автоматически возьмет файл `yandex_market_template.xlsx` и создаст `yandex_market.xml`.

Вы также можете указать другие имена файлов:

```bash
go run excel_to_yml.go -input мой_шаблон.xlsx -output мой_фид.xml
```

### Сборка исполняемого файла

В проекте уже есть скомпилированные программы для macOS (`yandex_fid_mac`) и Windows (`yandex_fid_windows.exe`), которые вы можете использовать сразу.

Если вы хотите скомпилировать программу самостоятельно, используйте следующие команды:

#### Для macOS:

```bash
go build -o yandex_fid_mac excel_to_yml.go
```

#### Для Windows (кросс-компиляция на macOS/Linux):

```bash
GOOS=windows GOARCH=amd64 go build -o yandex_fid_windows.exe excel_to_yml.go
```

#### Для Linux:

```bash
GOOS=linux GOARCH=amd64 go build -o yandex_fid_linux excel_to_yml.go
```

После сборки вы можете запустить программу:

```bash
# На macOS/Linux
./yandex_fid_mac

# На Windows
yandex_fid_windows.exe
```

или с параметрами:

```bash
# На macOS/Linux
./yandex_fid_mac -input мой_шаблон.xlsx -output мой_фид.xml

# На Windows
yandex_fid_windows.exe -input мой_шаблон.xlsx -output мой_фид.xml
```

### Заполнение шаблона

Используйте шаблон Excel `yandex_market_template.xlsx` и заполните следующие листы:

1. **Настройки магазина** - основная информация о вашем магазине (обязательно)
2. **Валюты** - используемые валюты и их курсы (обязательно)
3. **Категории** - структура категорий вашего магазина (обязательно)
4. **Товары** - информация о товарах (обязательно)

Обязательные поля для каждого листа:
- **Настройки магазина**: Название магазина, Название компании, URL магазина
- **Валюты**: ID валюты, Курс
- **Категории**: ID категории, Название категории
- **Товары**: ID товара, Название товара, Цена, Валюта (ID), ID категории

### Параметры командной строки

- `-input` - путь к входному Excel-файлу (по умолчанию: yandex_market_template.xlsx)
- `-output` - путь к выходному YML-файлу (по умолчанию: yandex_market.xml)

## Структура YML-фида

YML (Yandex Market Language) - это формат XML, используемый для передачи данных о товарах в Яндекс.Маркет. Основные элементы:

- `yml_catalog` - корневой элемент
  - `shop` - информация о магазине
    - `name` - название магазина
    - `company` - название компании
    - `url` - URL сайта магазина
    - `currencies` - список валют
    - `categories` - список категорий
    - `offers` - список товаров

## Запуск исполняемого файла

После сборки исполняемого файла вы можете запускать его напрямую:

```bash
./yandex_fid
```

При запуске без аргументов программа автоматически сгенерирует XML-фид из файла `yandex_market_template.xlsx`.

## Примечания

- Убедитесь, что все обязательные поля заполнены в шаблоне Excel
- Для товаров с несколькими параметрами (например, разными размерами) используйте одинаковый ID товара в разных строках

## Решение проблем

### Ошибка при открытии Excel-файла

Убедитесь, что файл не открыт в другой программе и имеет правильный формат.

### Проблемы с кодировкой

Убедитесь, что в XML-файле используется кодировка UTF-8 без BOM.

## Лицензия

Этот проект распространяется под лицензией MIT.